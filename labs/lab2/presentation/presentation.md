---
## Front matter
lang: ru-RU
title: Презентация по лабораторной работе №2
subtitle: Настройка DNS-сервера"
author:
  - Лушин А.А.
institute:
  - Российский университет дружбы народов, Москва, Россия
  - Факультет Физико-математических и естественных наук
date: 18 февраля 2005

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Лушин Артём Андреевич
  * Бакалавр направления компьютерные и информационные науки
  * Кафедра теории вероятности и кибербезопасности
  * Российский университет дружбы народов
  * Редактор Первого Федерального канала
  * [lusin5745@gmail.com](mailto:lusin5745@gmail.com)

:::
::: {.column width="30%"}

![](/home/aalushin/фдд/new2/study_2024-2025_admin/labs/lab2/presentation/image/me.jpg)

:::
::::::::::::::

# Вводная часть

## Цели и задачи

Приобретение практических навыков по установке и конфигурированию DNS-сервера, усвоение принципов работы системы доменных имён.

# Ход работы

## Анализ файлов 

С помощью установленной утилиты dig мы можем анализировать какие-то серверы и адреса. В нашем примере мы анализируем сервер яндекса и узнаём служебную информацию, время запроса, имя сервера, когда был создан и размер сообщений.

![](/home/aalushin/фдд/new2/study_2024-2025_admin/labs/lab2/presentation/image/3.jpg)

## Настройки DNS-сервера.

Сделали сервер по умолчанию для хоста-сервера и внутренней виртуальной сети. Настроил направление запросов от всех узлов внутренней сети через узел сервера. Изменили настройки межсетевого экрана узла сервера, разрешив работу с днс. 

![](/home/aalushin/фдд/new2/study_2024-2025_admin/labs/lab2/presentation/image/6.jpg)

## Изменение DNS-зоны

Взял описание днс-зоны и перенёс в рабочую папку. Включил файл днс-зоны в конфигурационный файл. Сделали обратную и прямую днс-зону. Внёс оба скрипта в соответствующие папки. 

![](/home/aalushin/фдд/new2/study_2024-2025_admin/labs/lab2/presentation/image/14.jpg)

## Итоговая корректировка

Изменил права доступа к файлам, чтобы они стали исполнительными. Восстановил метки безопасности в Selinux. Запустил расширенный лог систем, чтобы проверить корректность работы и перезапустил днс-сервер.

![](/home/aalushin/фдд/new2/study_2024-2025_admin/labs/lab2/presentation/image/28.jpg)

## Перенос на основную ОС

В каталоге vagrant/provision/server создал подкаталог DNS, куда внёс все рабочие подкаталоги и конфигурационные файлы. Создал исполняющий файл и заполнил его. На основной ОС внёс изменения в vagrantfile.

![](/home/aalushin/фдд/new2/study_2024-2025_admin/labs/lab2/presentation/image/33.jpg)

# Результаты

## Вывод 

Я приобрёл практические навыки по установке и конфигурированию DNS-сервера, усвоил принцип работы системы доменных имён.

## Контрольные вопросы 

1) Что такое DNS?

- Система доменных имён (Domain Name System, DNS) — распределённая система (распределённая база данных), ставящая в соответствие доменному имени хоста (компьютера или другого сетевого устройства) IP-адрес, и наоборот.

2) Каково назначение кэширующего DNS-сервера?

- Кэширующий DNS-сервер получает рекурсивные запросы от клиентов и выполняет их с помощью нерекурсивных запросов к авторитативным серверам.

3) Чем отличается прямая DNS-зона от обратной?

- Прямая DNS зона - зона хранения записей соответствия доменного имени ip адресу. Обратная DNS зона - зона хранения записей соответствия ip адреса доменному имени.

4) В каких каталогах и файлах располагаются настройки DNS-сервера? Кратко охарактеризуйте, за что они отвечают.

- В каталоге /etc хранится файл named.conf, в котором есть информация об опциях сервера, его разрешениях, настройках безопасности и подключены файлы зон. В каталоге /named хранится файл описания DNS-зон, также в каталоге /var/named хранится файл named.loopback, описывающий обратную зону, и файл named.localhost, описывающий прямую зону.

5) Что указывается в файле resolv.conf?

- В этом файле указывается имя сервера и его адрес.

6) Какие типы записи описания ресурсов есть в DNS и для чего они используются?

Основные типы ресурсных записей (Resource Records):

- A-запись — задает преобразование имени хоста в IP-адрес.

- MX-запись — определяет почтовый ретранслятор для доменного имени, т.е. узел, который обработает или передаст дальше почтовые сообщения, предназначенные адресату в указанном домене. При наличии нескольких MX-записей сначала происходит попытка доставить почту на ретранслятор с наименьшим приоритетом.

- NS-записи — определяют DNS-серверы, которые являются авторитативными для данной зоны.

- CNAME-запись — определяет отображение псевдонима в каноническое имя узла.

- SRV-запись — позволяет получить имя для искомой службы, а также протокол, по которому эта служба работает.

- TXT-запись — содержит общую текстовую информацию. Эти записи могут использоваться в любых целях, например, для указания месторасположения хоста.

- AAAA-запись — задает преобразование имени хоста в IPV6-адрес.

- SSHFP-запись — используется для хранения слепка ключей SSH в DNS.

7) Для чего используется домен in-addr.arpa? 

- Домен in-addr.arpa используется для всех сетей TCP/IP, основанным на адресации протокола Интернета 4 (IPv4).

8) Для чего нужен демон named?

- Демон named отвечает на запросы об именах машин и их IP-адресах. Если named не знает ответа на какой-либо запрос, он опрашивает другие серверы и помещает их ответы в кэш. Этот демон, кроме того, отвечает за выполнение зонных пересылок, обеспечивающих копирование данных между серверами одного домена. Запросы демона named используют протокол UDP и порт 53. Если объем ответов превышает 512 байтов, то для их доставки используется протокол TCP. В зонных пересылках между серверами также применяется протокол TCP.

9) В чём заключаются основные функции slave-сервера и master-сервера?

- Главный (master) — хранит и управляет ресурсными записями (описанием) доменной зоны. К главному серверу может быть подключено множество ведомых; ведомый (slave) — получает и хранит информацию о доменных зонах с главного сервера. На ведомом сервере невозможно изменить описание доменной зоны.

10) Какие параметры отвечают за время обновления зоны?

- SOA-запись (Start of Authority) — начальная запись зоны, которая указывает местоположение эталонной записи о домене. Она хранит параметр TTL – время, в течение которого информация будет кешироваться другими DNS-серверами. Также параметр Refresh – время (в секундах) ожидания ответа вторичного DNS перед запросом SOA-записи с первичных серверов. По истечении данного времени вторичный DNS обращается к первичному для получения копии текущей SOA-записи. Первичный DNS-сервер выполняет этот запрос. Вторичный DNS-сервер сравнивает полученный серийный номер зоны с имеющимся. Если они отличаются, то осуществляется запрос к первичному DNS-серверу на трансфер зоны. И Expire – время (в секундах), в течение которого вторичный DNS будет пытаться завершить синхронизацию зоны с первичным. Если это время истечет до того, как синхронизация закончится, то зона на вторичном DNS-сервере перестанет обслуживать запросы об этой зоне.

11) Как обеспечить защиту зоны от скачивания и просмотра?

Можно делать следующее для защиты данных DNS доменов с помощью DNSSEC:

- Подписывать зоны или удалить подпись в соответствии со спецификациями DNSSEC

- (Необязательно) Указывать индивидуальные настройки для создания ключей

- Получать уведомления

- Просматривать и копировать записи ресурсов DS

- Просматривать и копировать наборы записей ресурсов DNSKEY.

12) Какая запись RR применяется при создании почтовых серверов?

- Заппись MX (от англ. mail exchanger) — тип DNS-записи, предназначенный для маршрутизации электронной почты с использованием протокола SMTP.

13) Как протестировать работу сервера доменных имён?

- Для этого можно воспользоваться командой nslookup, которая позволяет получить информацию о DNS-записях для заданного домена или IP-адреса.

14) Как запустить, перезапустить или остановить какую-либо службу в системе?

- systemctl restart named - перезапустить DNS-сервер

- systemctl stop named - перезапустить DNS-сервер

- systemctl start named - перезапустить DNS-сервер

15) Как посмотреть отладочную информацию при запуске какого-либо сервиса или службы?

- В дополнительном терминале запуститm в режиме реального времени расширенный лог системных сообщений: journalctl -x -f

16) Где храниться отладочная информация по работе системы и служб? Как её посмотреть?

- Журналы службы находятся в директории “/var/log/” в виде обычных текстовых файлов.

17) Как посмотреть, какие файлы использует в своей работе тот или иной процесс? Приведите несколько примеров

- lsof – есокращение от LiSt of Open Files, утилита эта служит для вывода информации о том, какие файлы используются теми или иными процессами. В качестве примера могу привести 16 пункт моей лабораторной работы. Там мы используем команду grep.

18) Приведите несколько примеров по изменению сетевого соединения при помощи командного интерфейса nmcli.

- В качестве примера могу привести 11 и 12 пункты моей лабораторной.

19) Что такое SELinux?

- SELinux (англ. Security-Enhanced Linux — Linux с улучшенной безопасностью) — реализация системы принудительного контроля доступа, которая может работать параллельно с классической избирательной системой контроля доступа.

20) Что такое контекст (метка) SELinux?

- SELinux — это система принудительного управления доступом, что означает, что каждый процесс имеет метку (label). Каждый файл, каталог и системный объект так же имеют метки. Правила политики управляют доступом между промаркированными процессами и объектами.

- Контекст безопасности — это совокупность всех атрибутов, которые связаны с объектами и субъектами

21) Как восстановить контекст SELinux после внесения изменений в конфигурационные файлы? 

После изменения доступа к конфигурационным файлам named требуется корректно восстановить их метки в SELinux:

restorecon -vR /etc restorecon -vR /var/named

Для проверки состояния переключателей SELinux, относящихся к named, надо ввести:

getsebool -a | grep named

При необходимости дать named разрешение на запись в файлы DNS-зоны:

setsebool named_write_master_zones 1 setsebool -P named_write_master_zones 1

22) Как создать разрешающие правила политики SELinux из файлов журналов, содержащих сообщения о запрете операций?

- Чтобы создать необходимые политики:

1. Создайте новый файл с исходным кодом политики SELinux (.te файл). Данный файл определяет ограничения, относящиеся к описываемому модулю.

2. При необходимости отредактируйте сгенерированный исходный файл политики [module_name].te, а затем, используя утилиту checkmodule, создайте бинарное представление (.mod файл) исходного файла локальной политики.

3. Создайте устанавливаемый модуль политики (.pp файл) с помощью утилиты semodule_package.

4. Для установки созданного модуля политики воспользуйтесь утилитой semodule.

23) Что такое булевый переключатель в SELinux?

- Булевый переключатель в SELinux - это параметр, который управляет разрешениями безопасности на уровне SELinux. Он может быть включен (true) или выключен (false) и используется для разрешения или запрещения определенных действий.

24) Как посмотреть список переключателей SELinux и их состояние? 

- Для просмотра списка переключателей SELinux и их состояния можно использовать команду “semanage boolean -l” в терминале.

25) Как изменить значение переключателя SELinux?

- Чтобы изменить значение переключателя SELinux, можно использовать команду “setsebool”. Например, для включения переключателя с именем “httpd_can_network_connect” можно выполнить команду “setsebool -P httpd_can_network_connect 1”. Здесь -P указывает, что изменение должно быть постоянным (постоянно сохраняться после перезагрузки).


